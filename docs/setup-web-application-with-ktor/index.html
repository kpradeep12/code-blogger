<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="google-site-verification" content="17GXTKdnqGMgpkrc7Kbz323f4wg41DzBsDcNsfnHmVo" />
<!--below verification is techstackjava.com-->
<meta name="google-site-verification" content="tuMqCtGo9Q2zjZ6e2k1iswdB1R56vqiqYfbSrrzlyRE" />
<meta name="google-site-verification" content="6prhbit_zvr5fgjCg8h5zm8eH7tQrVeMcbHGOhb393g" />
<!-- Twitter cards-->
<meta name="twitter:site"    content="@PradeepK4J">
<meta name="twitter:creator" content="@pradeep">
<meta name="twitter:title"   content="Setup Web Application With Ktor">

<meta name="twitter:card"  content="summary_large_image">
<meta name="twitter:image" content="http://thetechstack.net/assets/images/banners/create-rest-services-using-ktor.jpg">

<!-- end of Twitter cards -->


<link rel="icon" href="/assets/images/logo.png">
    
<!--<title>Setup Web Application With Ktor | The Tech Stack . Net</title>-->
    
<meta name="description" content=""> 
    
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
    
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.13/css/all.css" integrity="sha384-DNOHZ68U8hZfKXOrtjWvjxusGo9WQnrNx2sqG0tfsghAvtVlRW3tvkXWZh58N9jp" crossorigin="anonymous">
    
<link href="https://fonts.googleapis.com/css?family=Righteous%7CMerriweather:300,300i,400,400i,700,700i" rel="stylesheet">
    
<link href="/assets/css/screen.css" rel="stylesheet">
    
<link href="/assets/css/main.css" rel="stylesheet">

<!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Setup Web Application With Ktor | Pradeep’s Java and Kotlin blog</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Setup Web Application With Ktor" />
<meta name="author" content="pradeep" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Sharing my Java and Kotlin coding experiments in this blog" />
<meta property="og:description" content="Sharing my Java and Kotlin coding experiments in this blog" />
<link rel="canonical" href="http://thetechstack.net/setup-web-application-with-ktor/" />
<meta property="og:url" content="http://thetechstack.net/setup-web-application-with-ktor/" />
<meta property="og:site_name" content="Pradeep’s Java and Kotlin blog" />
<meta property="og:image" content="http://thetechstack.net/assets/images/banners/create-rest-services-using-ktor.jpg" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2019-02-28T20:11:10-05:00" />
<script type="application/ld+json">
{"url":"http://thetechstack.net/setup-web-application-with-ktor/","author":{"@type":"Person","name":"pradeep"},"description":"Sharing my Java and Kotlin coding experiments in this blog","headline":"Setup Web Application With Ktor","datePublished":"2019-02-28T20:11:10-05:00","dateModified":"2019-02-28T20:11:10-05:00","@type":"BlogPosting","image":"http://thetechstack.net/assets/images/banners/create-rest-services-using-ktor.jpg","mainEntityOfPage":{"@type":"WebPage","@id":"http://thetechstack.net/setup-web-application-with-ktor/"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->



<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-115619272-1', 'auto');
  ga('send', 'pageview');
</script>


</head>
    


<body class="layout-post">

    
<!-- Begin Menu Navigation
================================================== -->
<nav class="navbar navbar-expand-lg navbar-light bg-white fixed-top mediumnavigation nav-down">
    
    <div class="container pr-0">    
    
    <!-- Begin Logo -->
    <a class="navbar-brand" href="/">
    <img src="/" alt="The Tech Stack . Net">
    </a>
    <!-- End Logo -->
  
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarMediumish" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
    </button>
    
    
    <div class="collapse navbar-collapse" id="navbarMediumish">
       
        <!-- Begin Menu -->
        
            <ul class="navbar-nav ml-auto">
                <!--
                
                <li class="nav-item">
                
                <a class="nav-link" href="/index.html">Blog</a>
                </li>-->
                
                
                <li class="nav-item">
                
                <a class="nav-link" href="/about">About Me</a>
                </li>
                
                
                <li class="nav-item">
                
                <a class="nav-link" href="/twitter">Twitter</a>
                </li>
                <!--
                <li class="nav-item">
                <a target="_blank"  class="nav-link" href="https://twitter.com/PradeepK4J"><i class="fab fa-twitter"></i></a>
                </li>-->
                
            </ul>		
  
        <!-- End Menu -->

    </div>
        
    </div>
</nav>
<!-- End Navigation
================================================== -->
    
<div class="site-content">   
<div class="container">
    
<!-- Site Title
================================================== -->
<div class="mainheading">
    <h1 class="sitetitle">The Tech Stack . Net</h1>
    <p class="lead">
         Sharing my Java and Kotlin coding experiments in this blog
    </p>
</div>

    
    
<!-- Content
================================================== --> 
<div class="main-content">
    <!-- Begin Article
================================================== -->
<div class="container">
	<div class="row">

		<!-- Post Share -->
		<div class="col-md-2 pl-0">            
           <div class="share">
    <p>
        Share
    </p>
    <ul>
        <li class="ml-1 mr-1">
        <a target="_blank" href="https://twitter.com/intent/tweet?text=Setup Web Application With Ktor&url=http://thetechstack.net/setup-web-application-with-ktor/" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
        <i class="fab fa-twitter"></i>
        </a>
        </li>
        
        <li class="ml-1 mr-1">
        <a target="_blank" href="https://facebook.com/sharer.php?u=http://thetechstack.net/setup-web-application-with-ktor/" onclick="window.open(this.href, 'facebook-share', 'width=550,height=435');return false;">
        <i class="fab fa-facebook-f"></i>
        </a>
        </li>
        
        <li class="ml-1 mr-1">
        <a target="_blank" href="https://plus.google.com/share?url=http://thetechstack.net/setup-web-application-with-ktor/" onclick="window.open(this.href, 'facebook-google', 'width=550,height=435');return false;">
        <i class="fab fa-google"></i>
        </a>
        </li>
        
    </ul>
    
    <div class="sep">
    </div>				
    <ul>
        <li> 
        <a  class="small smoothscroll" href="#disqus_thread"></a>
        </li>
    </ul>
    
</div>  
		</div>
		

		<!-- Post -->        
        
        
		<div class="col-md-9 flex-first flex-md-unordered">
			<div class="mainheading">

                <!-- Author Box -->
                				
				<div class="row post-top-meta">
					<div class="col-md-2">
						<img class="author-thumb" src="/assets/images/author.jpg" alt="Pradeep Kundarapu">
					</div>
					<div class="col-md-10">
                        <a target="_blank" class="link-dark" href="http://thetechstack.net">Pradeep Kundarapu</a>
                        <a target="_blank" href="https://twitter.com/PradeepK4J" class="btn follow">Follow</a>
						<div class="author-description">Java & Kotlin developer, blogger and tech enthusiast.</div>						
					</div>
				</div>				
                
                
                <!-- Post Title -->
				<h1 class="posttitle">Setup Web Application With Ktor</h1> 
                
			</div>

			<!-- Post Featured Image -->
			<img class="featured-image img-fluid" src="http://thetechstack.net/assets/images/banners/create-rest-services-using-ktor.jpg" alt="Setup Web Application With Ktor">
			<!-- End Featured Image -->

			<!-- Post Content -->
			<div class="article-post">
				<p>Its easy to create a web application with <strong>Ktor</strong>. In this article I will explain the tools we need and the process for developing a small CRUD based web application. I will take <strong>Employee</strong> as an entity to demonstrate this application. To develop this application we are going to use below frameworks/libraries.</p>

<ul>
  <li>Ktor framework: Develop asynchronous servers and clients.</li>
  <li>FreeMarker: Template engine to generate text output. We are using it for HTML pages.</li>
  <li>H2 database: In-memory and very fast database.</li>
  <li>Exposed SQL library: Light weight library for database access.</li>
</ul>

<p>If you are new to Exposed and Ktor framework then please go through below series of articles. These articles will give you basic understanding with examples.</p>

<ul>
  <li><a href="">Exposed SQL Library</a></li>
  <li><a href="">Ktor rest</a></li>
</ul>

<p>We will develop some web pages using Freemarker to show employees and to add/edit employee. To construct these web pages we are going to use <strong>Bootstrap</strong> CSS framework, because bootstrap provides many styles to develop web pages faster. We are going through below checklist to develop this application.</p>

<p><strong>Table of contents</strong></p>
<ul id="markdown-toc">
  <li><a href="#create-kotlin-project" id="markdown-toc-create-kotlin-project">Create Kotlin project</a></li>
  <li><a href="#add-and-configure-ktor-framework" id="markdown-toc-add-and-configure-ktor-framework">Add and configure Ktor framework</a>    <ul>
      <li><a href="#configure-netty-embedded-server" id="markdown-toc-configure-netty-embedded-server">Configure Netty embedded server</a></li>
    </ul>
  </li>
  <li><a href="#dao-layer-for-database" id="markdown-toc-dao-layer-for-database">DAO layer for database</a>    <ul>
      <li><a href="#integrate-exposed-with-ktor" id="markdown-toc-integrate-exposed-with-ktor">Integrate Exposed with Ktor</a></li>
    </ul>
  </li>
  <li><a href="#configure-freemarker" id="markdown-toc-configure-freemarker">Configure FreeMarker</a>    <ul>
      <li><a href="#create-templates" id="markdown-toc-create-templates">Create templates</a></li>
      <li><a href="#declare-controllers" id="markdown-toc-declare-controllers">Declare controllers</a></li>
    </ul>
  </li>
  <li><a href="#conclusion" id="markdown-toc-conclusion">Conclusion</a></li>
</ul>

<blockquote>
  <p>Please note that this whole project setup is available in <a href="https://github.com/kpradeep12/myprojects/tree/master/ktor-rest">github</a></p>
</blockquote>

<h3 id="create-kotlin-project">Create Kotlin project</h3>

<p>First step is to create Kotlin project. Execute below command to create an empty maven Kotlin project. Once the project is created then import it into your favorite editor.</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">mvn archetype:generate <span class="se">\</span>
<span class="nt">-DgroupId</span><span class="o">=</span>net.thetechstack <span class="se">\</span>
<span class="nt">-DartifactId</span><span class="o">=</span>ktor-freemarker <span class="se">\</span>
<span class="nt">-DarchetypeGroupId</span><span class="o">=</span>org.jetbrains.kotlin <span class="se">\</span>
<span class="nt">-DarchetypeArtifactId</span><span class="o">=</span>kotlin-archetype-jvm <span class="se">\</span>
<span class="nt">-DarchetypeVersion</span><span class="o">=</span>1.3.20 <span class="se">\</span>
<span class="nt">-DinteractiveMode</span><span class="o">=</span><span class="nb">false</span></code></pre></figure>

<blockquote>
  <p>I executed this command on Maven 3.6.0 version.</p>
</blockquote>

<p>This command will create new project with standard Maven folder structure and having default <strong>Hello.kt</strong> file. Rename this file to <strong>Application.kt</strong> because this will contain <strong>main()</strong> function and it will be starting point of our server execution.</p>

<h3 id="add-and-configure-ktor-framework">Add and configure Ktor framework</h3>

<p>Adding <strong>Ktor</strong> framework to the project is easy, just add below dependencies to your pom.xml.</p>

<table class="table table-striped">
  <thead>
    <tr>
      <th>Group Id</th>
      <th>Artifact Id</th>
      <th>Version</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>io.ktor</td>
      <td>ktor-server-core</td>
      <td>1.1.2</td>
      <td>Ktor core library</td>
    </tr>
    <tr>
      <td>io.ktor</td>
      <td>ktor-server-netty</td>
      <td>1.1.2</td>
      <td>Ktor supports Jetty, Netty and Tomcat as embedded servers. In this article I am using Netty.</td>
    </tr>
    <tr>
      <td>ch.qos.logback</td>
      <td>logback-classic</td>
      <td>1.2.3</td>
      <td>Ktor needs SLF4J implementation for logging</td>
    </tr>
  </tbody>
</table>

<h4 id="configure-netty-embedded-server">Configure Netty embedded server</h4>

<p>Go to <strong>Application.kt</strong> and update it with below code.</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="n">net</span><span class="o">.</span><span class="na">thetechstack</span>

<span class="kn">import</span> <span class="nn">io.ktor.application.install</span>
<span class="kn">import</span> <span class="nn">io.ktor.features.CallLogging</span>
<span class="kn">import</span> <span class="nn">io.ktor.features.ContentNegotiation</span>
<span class="kn">import</span> <span class="nn">io.ktor.server.engine.embeddedServer</span>
<span class="kn">import</span> <span class="nn">io.ktor.server.netty.Netty</span>

<span class="n">fun</span> <span class="nf">main</span><span class="o">()</span> <span class="o">{</span>
    <span class="n">embeddedServer</span><span class="o">(</span><span class="n">Netty</span><span class="o">,</span> <span class="n">port</span> <span class="o">=</span> <span class="mi">8080</span><span class="o">){</span> <span class="o">}.</span><span class="na">start</span><span class="o">(</span><span class="n">wait</span> <span class="o">=</span> <span class="kc">true</span><span class="o">)</span>
<span class="o">}</span></code></pre></figure>

<p><strong>embeddedServer</strong> function will initiate and run the embedded server. We need to pass some important information to it, they are;</p>

<ul>
  <li>Server instance type; We passed Netty. Ktor support Jetty and Tomcat as well.</li>
  <li>Port number on which the server will listen.</li>
  <li>Lambda instance of <strong>Application</strong>. WMore details about this in next section.</li>
</ul>

<h3 id="dao-layer-for-database">DAO layer for database</h3>

<p>We are using <strong>Exposed</strong> to connect and perform SQL operations on H2 in-memory database. We need to include required dependencies in the pom.xml so go to pom.xml and add below dependencies.</p>

<table class="table table-striped">
  <thead>
    <tr>
      <th>Group Id</th>
      <th>Artifact Id</th>
      <th>Version</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>org.jetbrains.exposed</td>
      <td><strong>exposed</strong></td>
      <td>0.12.1</td>
      <td>Light weight SQL library</td>
    </tr>
    <tr>
      <td>joda-time</td>
      <td><strong>joda-time</strong></td>
      <td>2.9.2</td>
      <td>Exposed depends on this library</td>
    </tr>
    <tr>
      <td>com.h2database</td>
      <td><strong>h2</strong></td>
      <td>1.4.191</td>
      <td>H2 is an in-memory database, its quick and easy to use.</td>
    </tr>
  </tbody>
</table>

<blockquote>
  <p>To learn more about SQL library <strong>Exposed</strong> please read this <a href="/light-weight-sql-kotlin-library">article</a>
To learn more on DAO layer please read this <a href="">article</a></p>
</blockquote>

<h4 id="integrate-exposed-with-ktor">Integrate Exposed with Ktor</h4>

<p>Lets integrate DAO layer with Ktor. We need to instantiate <strong>DAOFacadeDatabase</strong> by passing H2 in-memory database instance. Update <strong>Application.kt</strong> with below code;</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">val</span> <span class="n">dao</span> <span class="o">=</span> <span class="n">DAOFacadeDatabase</span><span class="o">(</span><span class="n">Database</span><span class="o">.</span><span class="na">connect</span><span class="o">(</span><span class="s">"jdbc:h2:mem:test;DB_CLOSE_DELAY=-1"</span><span class="o">,</span> <span class="n">driver</span> <span class="o">=</span> <span class="s">"org.h2.Driver"</span><span class="o">))</span>
<span class="n">fun</span> <span class="nf">main</span><span class="o">()</span> <span class="o">{</span>
    <span class="n">embeddedServer</span><span class="o">(</span><span class="n">Netty</span><span class="o">,</span> <span class="n">port</span> <span class="o">=</span> <span class="mi">8080</span><span class="o">){</span>
        <span class="n">dao</span><span class="o">.</span><span class="na">init</span><span class="o">()</span>
    <span class="o">}.</span><span class="na">start</span><span class="o">(</span><span class="n">wait</span> <span class="o">=</span> <span class="kc">true</span><span class="o">)</span></code></pre></figure>

<p>Instantiated <strong>DAOFacadeDatabase</strong> by passing H2 database instance and used this instance to create the tables by calling <strong>init()</strong></p>

<h3 id="configure-freemarker">Configure FreeMarker</h3>

<p>Update pom.xml with below dependency to add support for FreeMarker templates;</p>

<table class="table table-striped">
  <thead>
    <tr>
      <th>Group Id</th>
      <th>Artifact Id</th>
      <th>Version</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>io.ktor</td>
      <td><strong>ktor-freemarker</strong></td>
      <td>1.1.2</td>
      <td>FreeMarker library</td>
    </tr>
  </tbody>
</table>

<p>We will save all our FreeMarker templates in <strong>resources/templates</strong> directory so create these directories under <strong>ktor-freemarker/src/main/</strong></p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">embeddedServer</span><span class="o">(</span><span class="n">Netty</span><span class="o">,</span> <span class="n">port</span> <span class="o">=</span> <span class="mi">8080</span><span class="o">){</span>
        <span class="n">dao</span><span class="o">.</span><span class="na">init</span><span class="o">()</span>
        <span class="n">install</span><span class="o">(</span><span class="n">FreeMarker</span><span class="o">){</span>
            <span class="n">templateLoader</span> <span class="o">=</span> <span class="n">ClassTemplateLoader</span><span class="o">(</span><span class="k">this</span><span class="o">::</span><span class="kd">class</span><span class="err">.</span><span class="nc">java</span><span class="o">.</span><span class="na">classLoader</span><span class="o">,</span> <span class="s">"templates"</span><span class="o">)</span>
        <span class="o">}</span>
    <span class="o">}.</span><span class="na">start</span><span class="o">(</span><span class="n">wait</span> <span class="o">=</span> <span class="kc">true</span><span class="o">)</span></code></pre></figure>

<p>We installed <strong>FreeMarker</strong> feature on the request and response pipeline by passing FreeMarker configuration to <strong>install</strong> function. Configuration mentions the folder name of the FreeMarker templates and by default it will check under <strong>resources</strong> directory.</p>

<h4 id="create-templates">Create templates</h4>

<p>We need three template files;</p>

<ul>
  <li><strong>template.ftl</strong>: This is the main template of our application. This contains the framework for our page.</li>
  <li><strong>index.ftl</strong>: Default page which will list all employees and gives options to add/edit/delete employees.</li>
  <li><strong>employee.ftl</strong>: This page allows us to add/edit employee</li>
</ul>

<p><strong>template.ftl</strong></p>

<figure class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;</span><span class="err">#</span><span class="na">macro</span> <span class="na">mainLayout</span> <span class="na">title=</span><span class="s">"Welcome to Employee Database"</span><span class="nt">&gt;</span>
    <span class="cp">&lt;!doctype html&gt;</span>
    <span class="nt">&lt;html</span> <span class="na">lang=</span><span class="s">"en"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;head&gt;</span>
            <span class="nt">&lt;title&gt;</span>${title}<span class="nt">&lt;/title&gt;</span>
            <span class="c">&lt;!-- Required meta tags --&gt;</span>
            <span class="nt">&lt;meta</span> <span class="na">charset=</span><span class="s">"utf-8"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;meta</span> <span class="na">name=</span><span class="s">"viewport"</span> <span class="na">content=</span><span class="s">"width=device-width, initial-scale=1, shrink-to-fit=no"</span><span class="nt">&gt;</span>
            <span class="c">&lt;!-- Bootstrap CSS --&gt;</span>
            <span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">"stylesheet"</span> <span class="na">href=</span><span class="s">"https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css"</span> <span class="na">integrity=</span><span class="s">"sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO"</span> <span class="na">crossorigin=</span><span class="s">"anonymous"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;/head&gt;</span>
        <span class="nt">&lt;body&gt;</span>
            <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"container"</span><span class="nt">&gt;</span>
                <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"row mt-2 mb-2"</span><span class="nt">&gt;</span>
                    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"col"</span><span class="nt">&gt;</span>
                        <span class="nt">&lt;h3&gt;</span>Employees<span class="nt">&lt;/h3&gt;</span>
                    <span class="nt">&lt;/div&gt;</span>
                <span class="nt">&lt;/div&gt;</span>
                <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"row"</span><span class="nt">&gt;</span>
                    <span class="nt">&lt;</span><span class="err">#</span><span class="na">nested</span><span class="nt">/&gt;</span>
                <span class="nt">&lt;/div&gt;</span>
            <span class="nt">&lt;/div&gt;</span>

            <span class="c">&lt;!-- Optional JavaScript --&gt;</span>
            <span class="c">&lt;!-- jQuery first, then Popper.js, then Bootstrap JS --&gt;</span>
            <span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"https://code.jquery.com/jquery-3.3.1.slim.min.js"</span> <span class="na">integrity=</span><span class="s">"sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"</span> <span class="na">crossorigin=</span><span class="s">"anonymous"</span><span class="nt">&gt;&lt;/script&gt;</span>
            <span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js"</span> <span class="na">integrity=</span><span class="s">"sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49"</span> <span class="na">crossorigin=</span><span class="s">"anonymous"</span><span class="nt">&gt;&lt;/script&gt;</span>
            <span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"</span> <span class="na">integrity=</span><span class="s">"sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy"</span> <span class="na">crossorigin=</span><span class="s">"anonymous"</span><span class="nt">&gt;&lt;/script&gt;</span>
        <span class="nt">&lt;/body&gt;</span>
    <span class="nt">&lt;/html&gt;</span>
<span class="nt">&lt;/</span><span class="err">#</span><span class="nt">macro&gt;</span></code></pre></figure>

<p>This is the simple starter HTML page taken from <strong>Bootstrap</strong> website but I added some FreeMarker directives in it to make this page reusable. I used <strong>macro</strong> and <strong>nested</strong> directives;</p>

<p><strong>Macro</strong> is used to store reusable templates and we can refer them with there names. In below code I created a macro with named <strong>test</strong>. This macro contains reusable block, in this case it is having <strong>Hello</strong> with in <strong>p</strong> tab. If I want to use then call it like <strong>&lt;@test/&gt;</strong> so the contents of the macro will be replaced. Below code will output ‘Hello’.</p>

<figure class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;</span><span class="err">#</span><span class="na">macro</span> <span class="na">test</span><span class="nt">&gt;</span>
    <span class="nt">&lt;p&gt;</span>Hello<span class="nt">&lt;/p&gt;</span>
<span class="nt">&lt;/</span><span class="err">#</span><span class="nt">macro&gt;</span>

<span class="nt">&lt;</span><span class="err">@</span><span class="na">test</span><span class="nt">/&gt;</span>
<span class="nt">&lt;</span><span class="err">@</span><span class="na">test</span><span class="nt">/&gt;</span></code></pre></figure>

<p>Macro can take parameters. We need to declare and pass value to it so it can be used in the template.</p>

<figure class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;</span><span class="err">#</span><span class="na">macro</span> <span class="na">test</span> <span class="na">name</span><span class="nt">&gt;</span>
    <span class="nt">&lt;p&gt;</span>Hello ${name}<span class="nt">&lt;/p&gt;</span>
<span class="nt">&lt;/</span><span class="err">#</span><span class="nt">macro&gt;</span>

<span class="nt">&lt;</span><span class="err">@</span><span class="na">test</span> <span class="na">name=</span><span class="s">"World"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;</span><span class="err">@</span><span class="na">test</span> <span class="na">name=</span><span class="s">"FreeMarker"</span><span class="nt">/&gt;</span></code></pre></figure>

<blockquote>
  <p>More information on the macro is available on the FreeMarker <a href="https://freemarker.apache.org/docs/ref_directive_macro.html">site</a>.</p>
</blockquote>

<p>Instead of Macro having its own content we can pass content to it using <strong>Nested</strong>. In this case macro acts like a border around the nested. In below example instead of macro having the content we are passing ‘Hello’ to it and macro will replace &lt;#nested&gt; with the content.</p>

<figure class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;</span><span class="err">#</span><span class="na">macro</span> <span class="na">test</span><span class="nt">&gt;</span>
    <span class="nt">&lt;</span><span class="err">#</span><span class="na">nested</span><span class="nt">&gt;</span>
<span class="nt">&lt;/</span><span class="err">#</span><span class="nt">macro&gt;</span>
<span class="nt">&lt;</span><span class="err">@</span><span class="na">test</span><span class="nt">&gt;&lt;p&gt;</span>Hello<span class="nt">&lt;/p&gt;&lt;/</span><span class="err">@</span><span class="nt">test&gt;</span></code></pre></figure>

<p><strong>template.ftl</strong> uses macro and nested to define our web page structure. We called our macro as <em>mainLayout</em> this contains and with in the body we have <strong>nested</strong> so what ever we pass to this macro will get all bootstrap dependencies. In future if we want to change the version of the bootstrap then this is the only file we need to change.</p>

<p><strong>index.ftl</strong></p>

<figure class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;</span><span class="err">#</span><span class="na">import</span> <span class="err">"</span><span class="na">template</span><span class="err">.</span><span class="na">ftl</span><span class="err">"</span> <span class="na">as</span> <span class="na">layout</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;</span><span class="err">@</span><span class="na">layout</span><span class="err">.</span><span class="na">mainLayout</span><span class="nt">&gt;</span>
    <span class="nt">&lt;table</span> <span class="na">class=</span><span class="s">"table"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;thead</span> <span class="na">class=</span><span class="s">"thead-dark"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;tr&gt;</span>
                <span class="nt">&lt;th</span> <span class="na">scope=</span><span class="s">"col"</span><span class="nt">&gt;</span>Id<span class="nt">&lt;/th&gt;</span>
                <span class="nt">&lt;th</span> <span class="na">scope=</span><span class="s">"col"</span><span class="nt">&gt;</span>Name<span class="nt">&lt;/th&gt;</span>
                <span class="nt">&lt;th</span> <span class="na">scope=</span><span class="s">"col"</span><span class="nt">&gt;</span>Email<span class="nt">&lt;/th&gt;</span>
                <span class="nt">&lt;th</span> <span class="na">scope=</span><span class="s">"col"</span><span class="nt">&gt;</span>City<span class="nt">&lt;/th&gt;</span>
                <span class="nt">&lt;th&gt;&lt;/th&gt;</span>
            <span class="nt">&lt;/tr&gt;</span>
        <span class="nt">&lt;/thead&gt;</span>
        <span class="nt">&lt;tbody&gt;</span>
            <span class="nt">&lt;</span><span class="err">#</span><span class="na">list</span> <span class="na">employees</span> <span class="na">as</span> <span class="na">emp</span><span class="nt">&gt;</span>
            <span class="nt">&lt;tr&gt;</span>
                <span class="nt">&lt;td&gt;</span>${emp.id}<span class="nt">&lt;/td&gt;</span>
                <span class="nt">&lt;td&gt;</span>${emp.name}<span class="nt">&lt;/td&gt;</span>
                <span class="nt">&lt;td&gt;</span>${emp.email}<span class="nt">&lt;/td&gt;</span>
                <span class="nt">&lt;td&gt;</span>${emp.city}<span class="nt">&lt;/td&gt;</span>
                <span class="nt">&lt;td&gt;</span>
                    <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"/employee?action=edit&amp;id=${emp.id}"</span> <span class="na">class=</span><span class="s">"btn btn-secondary float-right mr-2"</span> <span class="na">role=</span><span class="s">"button"</span><span class="nt">&gt;</span>Edit<span class="nt">&lt;/a&gt;</span>
                    <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"/delete?id=${emp.id}"</span> <span class="na">class=</span><span class="s">"btn btn-danger float-right mr-2"</span> <span class="na">role=</span><span class="s">"button"</span><span class="nt">&gt;</span>Delete<span class="nt">&lt;/a&gt;</span>
                <span class="nt">&lt;/td&gt;</span>
            <span class="nt">&lt;/tr&gt;</span>
            <span class="nt">&lt;/</span><span class="err">#</span><span class="nt">list&gt;</span>
        <span class="nt">&lt;/tbody&gt;</span>
    <span class="nt">&lt;/table&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"container"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"row"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"/employee?action=new"</span> <span class="na">class=</span><span class="s">"btn btn-secondary float-right"</span> <span class="na">role=</span><span class="s">"button"</span><span class="nt">&gt;</span>New Employee<span class="nt">&lt;/a&gt;</span>
        <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/</span><span class="err">@</span><span class="nt">layout</span><span class="err">.mainLayout</span><span class="nt">&gt;</span></code></pre></figure>

<p><strong>index.ftl</strong> will show all employees in the table and allows users to add/edit/delete employees. We are importing <strong>template.ftl</strong> as <strong>layout</strong> because we need to pass this file contents as nested to it. Then we used layout to call the macro <strong>&lt;@layout.mainLayout&gt;</strong></p>

<p>We used <strong>list</strong> directive to iterate employees and show them in the rows.</p>

<p>To add/edit we are passing <strong>action</strong> query parameter and for delete we are passing <strong>id</strong></p>

<p><strong>employee.ftl</strong></p>

<figure class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;</span><span class="err">#</span><span class="na">import</span> <span class="err">"</span><span class="na">template</span><span class="err">.</span><span class="na">ftl</span><span class="err">"</span> <span class="na">as</span> <span class="na">layout</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;</span><span class="err">@</span><span class="na">layout</span><span class="err">.</span><span class="na">mainLayout</span> <span class="na">title=</span><span class="s">"New Employee"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;form</span> <span class="na">action=</span><span class="s">"/employee"</span> <span class="na">method=</span><span class="s">"post"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"form-group"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">"name"</span><span class="nt">&gt;</span>Name<span class="nt">&lt;/label&gt;</span>
            <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">class=</span><span class="s">"form-control"</span> <span class="na">id=</span><span class="s">"name"</span> <span class="na">name=</span><span class="s">"name"</span> <span class="na">placeholder=</span><span class="s">"Enter Name"</span> <span class="na">value=</span><span class="s">"${(employee.name)!}"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;/div&gt;</span>
        <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"form-group"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">"email"</span><span class="nt">&gt;</span>Email<span class="nt">&lt;/label&gt;</span>
            <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"email"</span> <span class="na">class=</span><span class="s">"form-control"</span> <span class="na">id=</span><span class="s">"email"</span> <span class="na">name=</span><span class="s">"email"</span> <span class="na">placeholder=</span><span class="s">"Enter Email"</span> <span class="na">value=</span><span class="s">"${(employee.email)!}"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;/div&gt;</span>
        <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"form-group"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">"city"</span><span class="nt">&gt;</span>City<span class="nt">&lt;/label&gt;</span>
            <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">class=</span><span class="s">"form-control"</span> <span class="na">id=</span><span class="s">"city"</span> <span class="na">name=</span><span class="s">"city"</span> <span class="na">placeholder=</span><span class="s">"Enter City"</span> <span class="na">value=</span><span class="s">"${(employee.city)!}"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;/div&gt;</span>
        <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">id=</span><span class="s">"action"</span> <span class="na">name=</span><span class="s">"action"</span> <span class="na">value=</span><span class="s">"${action}"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">id=</span><span class="s">"id"</span> <span class="na">name=</span><span class="s">"id"</span> <span class="na">value=</span><span class="s">"${(employee.id)!}"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;button</span> <span class="na">type=</span><span class="s">"submit"</span> <span class="na">class=</span><span class="s">"btn btn-primary"</span><span class="nt">&gt;</span>Submit<span class="nt">&lt;/button&gt;</span>
    <span class="nt">&lt;/form&gt;</span>
<span class="nt">&lt;/</span><span class="err">@</span><span class="nt">layout</span><span class="err">.mainLayout</span><span class="nt">&gt;</span></code></pre></figure>

<ul>
  <li><strong>Add</strong>: <em>action</em> hidden field contains <em>new</em> or <em>edit</em> based on the request.</li>
  <li><strong>Edit</strong>: <em>id</em> hidden field contains id of the employee which are editing.</li>
</ul>

<h4 id="declare-controllers">Declare controllers</h4>

<h3 id="conclusion">Conclusion</h3>


			</div>

            <!-- Post Date -->
            <p>
            <small>
                <span class="post-date"><time class="post-date" datetime="2019-02-28">28 Feb 2019</time></span>           
                
                </small>
            </p>
            
			<!-- Post Categories -->
			<div class="after-post-tags">
				<ul class="tags">
                    
                    
                    <li>
                     <a href="/category/kotlin/">kotlin</a>
                    </li>
                    
				</ul>
			</div>
			<!-- End Categories -->
            
            <!-- Prev/Next -->
            <div class="row PageNavigation d-flex justify-content-between font-weight-bold">
            
            <a class="prev d-block col-md-6" href="http://thetechstack.net/rest-services-using-ktor/"> &laquo; Create REST services using Ktor</a>
            
            
            <div class="clearfix"></div>
            </div>
            <!-- End Categories -->

		</div>
		<!-- End Post -->

	</div>
</div>
<!-- End Article
================================================== -->

  

<!-- Begin Comments
================================================== -->

    <div class="container">
        <div id="comments" class="row justify-content-center mb-5">
            <div class="col-md-8">              
                
<section class="disqus">
    <div id="disqus_thread"></div>
    <script type="text/javascript">
        var disqus_shortname = 'thetechstack-net'; 
        var disqus_developer = 0;
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = window.location.protocol + '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</section>
                
            </div>
        </div>
    </div>

<!--End Comments
================================================== -->
</div>

<!-- Bottom Alert Bar
================================================== -->
<div class="alertbar">
	<div class="container text-center">
		<span><img src="/" alt="Pradeep's Java and Kotlin blog"> &nbsp; Never miss any <b>article</b>, subscribe to my newsletter</span>
        <form action="https://thetechstack.us7.list-manage.com/subscribe/post?u=1381d872f022743eb338f00a1&amp;id=88d9fceb21" method="post" name="mc-embedded-subscribe-form" class="wj-contact-form validate" target="_blank" novalidate>
            <div class="mc-field-group">
            <input type="email" placeholder="Email" name="EMAIL" class="required email" id="mce-EMAIL" autocomplete="on" required>
            <input type="submit" value="Subscribe" name="subscribe" class="heart">
            </div>
        </form>
	</div>
</div>
    
</div>

<div class="jumbotron fortags">
	<div class="d-md-flex h-100">
		<div class="col-md-4 transpdark align-self-center text-center h-100">
            <div class="d-md-flex align-items-center justify-content-center h-100">
                <h2 class="d-md-block align-self-center py-1 font-weight-light">Explore <span class="d-none d-md-inline">→</span></h2>
            </div>
		</div>
		<div class="col-md-8 p-5 align-self-center text-center">
            
          
             
              <a href="/category/java">Java (28)</a>
             
              <a href="/category/reactiveX">Reactivex (3)</a>
             
              <a href="/category/docker">Docker (2)</a>
             
              <a href="/category/tools">Tools (1)</a>
             
              <a href="/category/spring">Spring (2)</a>
             
              <a href="/category/kotlin">Kotlin (7)</a>
            
          
        

		</div>
	</div>
</div>
 


<!-- Begin Footer
================================================== -->
<footer class="footer">
    <div class="container">
        <div class="row">
            <div class="col-md-6 col-sm-6 text-center text-lg-left">
                 Copyright © 2019 The Tech Stack . Net 
            </div>
            <!--<div class="col-md-6 col-sm-6 text-center text-lg-right">    
                <a target="_blank" href="https://www.wowthemes.net">Mediumish Theme</a> by WowThemes.net
            </div>-->
        </div>
    </div>
</footer>
<!-- End Footer
================================================== -->

   
</div> 
<!-- Placed at the end of the document so the pages load faster -->
    
<script src="/assets/js/jquery.min.js"></script>
    
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
    
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>
    
<script src="/assets/js/ie10-viewport-bug-workaround.js"></script>
    
<script src="/assets/js/mediumish.js"></script>
    
<script id="dsq-count-scr" src="//thetechstack-net.disqus.com/count.js"></script>
</body>
</html>
